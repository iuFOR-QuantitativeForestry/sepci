"0","csa_function_selector <- function(species, LCR, HT, d, HLCR,  HBC){"
"0","  if(species == ""Quercus pyrenaica""){"
"0","    return(function(x){ccs_area_ellipsoid(HBC, HLCR, LCR, HT, x)})"
"0","    }"
"0","  if(species == ""Pinus nigra""){"
"0","    return(function(x){ccs_area_ellipsoid(HBC, HLCR, LCR, HT, x)})"
"0","    }"
"0","  if(species == ""Pinus sylvestris""){"
"0","    return(function(x){"
"0","      profile_equation_pinus_sylvestris(LCR, HT, d, HLCR,  HBC, x)})"
"0","  }"
"0","}"
"0",""
"0","tree_csa_functions <- apply(valdepoza$marks,1,"
"0","FUN = function(row) {"
"0","  names(row) <- colnames(valdepoza$marks)"
"0","  unlist(csa_function_selector(unlist(row[""species""]), as.numeric(row[""largestCrownRadius""]),"
"0","as.numeric(row[""height""]), as.numeric(row[""dbh""]), as.numeric(row[""heightLargestCrownRadius""]), "
"0","as.numeric(row[""heightStartCrown""])))})"
"0",""
"0","# We add this functions as a column to the marks"
"0","valdepoza$marks <- valdepoza$marks %>% mutate(csFunction = tree_csa_functions)"
